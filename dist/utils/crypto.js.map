{
  "version": 3,
  "sources": ["../../src/utils/crypto.ts"],
  "sourcesContent": ["/**\n * Extended greatest common divisor\n * Euclid's algorithm\n *\n * @param a paired with x in output\n * @param b paired with y in output\n */\nconst egcd = (a: bigint, b: bigint) => {\n  let x = 1n\n  let y = 0n\n  let r = 0n\n  let s = 1n\n\n  while (b !== 0n) {\n    let c = a % b\n    let q = a / b\n    a = b\n    b = c\n\n    let rPrim = r\n    let sPrim = s\n    r = x - q * r\n    s = y - q * s\n    x = rPrim\n    y = sPrim\n  }\n\n  return { a, x, y }\n}\n\n/**\n * Modulo\n *\n * @param a base\n * @param b modulus\n */\nconst mod = (a: bigint, b: bigint) => {\n  const x = a % b\n  return x < 0n ? x + b : x\n}\n\n/**\n * Congruences solution - Chinese remainder theorem\n *\n * Solves x for:\n * x mod modulus1 = remainder1\n * x mod modulus2 = remainder2\n * ...\n * x mod modulusN = remainderN\n *\n * @param congruences [modulus, remainder][]\n */\nconst crt = (congruences: [bigint, bigint][]) => {\n  return mod(\n    congruences\n      .map(([modulus, remainder]) => {\n        const N = congruences\n          .filter(([currBus]) => currBus !== modulus)\n          .reduce((acc, [modulus]) => acc * modulus, 1n)\n        return remainder * N * egcd(N, modulus).x\n      })\n      .reduce((a, b) => a + b),\n    congruences.reduce((acc, [modulus]) => acc * modulus, 1n),\n  )\n}\n\nexport default { egcd, mod, crt }\n"],
  "mappings": "AAOA,MAAM,OAAO,CAAC,GAAW,MAAc;AACrC,MAAI,IAAI;AACR,MAAI,IAAI;AACR,MAAI,IAAI;AACR,MAAI,IAAI;AAER,SAAO,MAAM,IAAI;AACf,QAAI,IAAI,IAAI;AACZ,QAAI,IAAI,IAAI;AACZ,QAAI;AACJ,QAAI;AAEJ,QAAI,QAAQ;AACZ,QAAI,QAAQ;AACZ,QAAI,IAAI,IAAI;AACZ,QAAI,IAAI,IAAI;AACZ,QAAI;AACJ,QAAI;AAAA;AAGN,SAAO,EAAE,GAAG,GAAG;AAAA;AASjB,MAAM,MAAM,CAAC,GAAW,MAAc;AACpC,QAAM,IAAI,IAAI;AACd,SAAO,IAAI,KAAK,IAAI,IAAI;AAAA;AAc1B,MAAM,MAAM,CAAC,gBAAoC;AAC/C,SAAO,IACL,YACG,IAAI,CAAC,CAAC,SAAS,eAAe;AAC7B,UAAM,IAAI,YACP,OAAO,CAAC,CAAC,aAAa,YAAY,SAClC,OAAO,CAAC,KAAK,CAAC,cAAa,MAAM,UAAS;AAC7C,WAAO,YAAY,IAAI,KAAK,GAAG,SAAS;AAAA,KAEzC,OAAO,CAAC,GAAG,MAAM,IAAI,IACxB,YAAY,OAAO,CAAC,KAAK,CAAC,aAAa,MAAM,SAAS;AAAA;AAI1D,IAAO,iBAAQ,EAAE,MAAM,KAAK;",
  "names": []
}
