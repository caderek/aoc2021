{
  "version": 3,
  "sources": ["../../src/utils/api.ts"],
  "sourcesContent": ["require(\"dotenv\").config()\n\nimport fetch from \"node-fetch\"\nimport { JSDOM } from \"jsdom\"\nimport { writeFileSync, existsSync, statSync } from \"fs\"\n\nconst strToNum = {\n  one: 1,\n  two: 2,\n  three: 3,\n  four: 4,\n  five: 5,\n  six: 6,\n  seven: 7,\n  eight: 8,\n  nine: 9,\n  ten: 10,\n}\n\nlet canSubmit = true\nlet delayStart = 0\nlet delayAmount = 0\n\nconst handleErrors = (e) => {\n  if (e.message === \"400\" || e.message === \"500\") {\n    console.log(\n      \"INVALID SESSION KEY\\nPlease make sure that the session key in the .env file is correct.\",\n    )\n  } else if (e.message.startsWith(\"5\")) {\n    console.log(\"SERVER ERROR\")\n  } else if (e.message === \"404\") {\n    console.log(\"CHALLENGE NOT YET AVAILABLE\")\n  } else {\n    console.log(\n      \"UNEXPECTED ERROR\\nPlease check your internet connection.\\n\\nIf you think it's a bug, create an issue on github.\\nHere are some details to include:\\n\",\n    )\n    console.log(e)\n  }\n}\n\nconst getInput = async (year: number, day: number, path: string) => {\n  if (existsSync(path) && statSync(path).size > 0) {\n    console.log(`INPUT FOR AOC ${year} DAY ${day} ALREADY FETCHED`)\n    return\n  }\n\n  fetch(`https://adventofcode.com/${year}/day/${day}/input`, {\n    headers: {\n      cookie: `session=${process.env.AOC_SESSION_KEY}`,\n    },\n  })\n    .then((res) => {\n      if (res.status !== 200) {\n        throw new Error(String(res.status))\n      }\n\n      return res.text()\n    })\n    .then((body) => {\n      writeFileSync(path, body.replace(/\\n$/, \"\"))\n      console.log(`INPUT FOR AOC ${year} DAY ${day} SAVED!`)\n    })\n    .catch(handleErrors)\n}\n\nconst sendSolution = (\n  year: number,\n  day: number,\n  part: 1 | 2,\n  solution: number | string,\n) => {\n  if (!canSubmit) {\n    console.log(\"you have to wait!\")\n    return\n  }\n\n  fetch(`https://adventofcode.com/${year}/day/${day}/answer`, {\n    headers: {\n      cookie: `session=${process.env.AOC_SESSION_KEY}`,\n      \"content-type\": \"application/x-www-form-urlencoded\",\n    },\n    method: \"POST\",\n    body: `level=${part}&answer=${solution}`,\n  })\n    .then((res) => {\n      if (res.status !== 200) {\n        throw new Error(String(res.status))\n      }\n\n      return res.text()\n    })\n    .then((body) => {\n      const info = new JSDOM(body).window.document\n        .querySelector(\"main\")\n        .textContent.replace(/\\[.*\\]/, \"\")\n        .trim()\n\n      if (info.includes(\"That's the right answer\")) {\n        console.log(`\\nStatus: PART ${part} SOLVED!`)\n      } else if (info.includes(\"That's not the right answer\")) {\n        console.log(\"\\nStatus: WRONG ANSWER\")\n        console.log(info)\n      } else if (info.includes(\"You gave an answer too recently\")) {\n        console.log(\"\\nStatus: TO SOON\")\n      } else if (\n        info.includes(\"You don't seem to be solving the right level\")\n      ) {\n        console.log(\"\\nStatus: ALREADY COMPLETED or LOCKED\")\n      } else {\n        console.log(\"\\nStatus: UNKNOWN RESPONSE\\n\")\n        console.log(info)\n      }\n\n      const waitStr = info.match(\n        /(one|two|three|four|five|six|seven|eight|nine|ten) (second|minute|hour|day)/,\n      )\n      const waitNum = info.match(/\\d+\\s*(s|m|h|d)/g)\n\n      if (waitStr !== null || waitNum !== null) {\n        const waitTime = {\n          s: 0,\n          m: 0,\n          h: 0,\n          d: 0,\n        }\n\n        if (waitStr !== null) {\n          const [_, time, unit] = waitStr\n          waitTime[unit[0]] = strToNum[time]\n        } else if (waitNum !== null) {\n          waitNum.forEach((x) => {\n            waitTime[x.slice(-1)] = Number(x.slice(0, -1))\n          })\n        }\n\n        canSubmit = false\n        delayStart = Date.now()\n        delayAmount =\n          (waitTime.d * 24 * 60 * 60 +\n            waitTime.h * 60 * 60 +\n            waitTime.m * 60 +\n            waitTime.s) *\n          1000\n\n        const delayStr = `${waitTime.d > 0 ? `${waitTime.d}d ` : \"\"}${\n          waitTime.h > 0 ? `${waitTime.h}h ` : \"\"\n        }${waitTime.m > 0 ? `${waitTime.m}m ` : \"\"}${\n          waitTime.s > 0 ? `${waitTime.s}s` : \"\"\n        }`\n\n        console.log(`Next request possible in: ${delayStr}`)\n      }\n    })\n    .catch(handleErrors)\n}\n\nexport { getInput, sendSolution }\n\n/*\nThat's the right answer!  You are one gold star closer to saving your vacation.You have completed Day 10! You can [Shareon\n  Twitter\n  Mastodon] this victory or .\n*/\n"],
  "mappings": "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",
  "names": []
}
